---
title: 文字无缝滚动跑马灯效果
date: 2017-08-09 10:11:00
categories:
    - Frontend
tags:
    - Javascript
    - Text
---

项目中遇到文字无缝滚动的需求，本着快速开发的原则，网上找了几个插件，但都不理想，最后决定自己写一个简单的。
<!-- more -->

## 1、`Html` 
```html
<div class="scroll">
    <ul>
        <li><a href="">1. 设计模式与开发实践。</a></li>
        <li><a href="">2. 习近平带领我们走过这不平凡的五年。</a></li>
        <li><a href="">3. 深化改革砥砺前行。</a></li>
        <li><a href="">4. 水果没有性别。</a></li>
        <li><a href="">5. 野猪双脏炮卡组攻略皇室战争传奇卡组推荐搭配。</a></li>
    </ul>
</div>
```
`.scroll` 是外层容器，`.scroll ul` 是具体滚动的容器。

## 2、`Style`
```css
.scroll{
    position: relative;  /* 必须有，不可删除 */
    width: 1000px;
    height: 30px;
    margin: 100px auto;
    background-color: #000;
    overflow: hidden;
}

.scroll ul{
    position: relative;
    left: 0;
    min-width: 1000px;
}

.scroll ul li{
    float: left;
    height: 30px;
    line-height: 30px;
    margin: 0 15px;
    white-space: nowrap;
}

.scroll ul li a{
    font-size: 14px;
    color: #fff;
    text-decoration: none;
}
```

## 3、`Javascript`
```javascript
(function() {
    var speed = 100,
        scroll = $('.scroll'),
        scrollWidth = scroll.outerWidth(), // 外层容器宽度
        scrollUL = scroll.find('ul'),
        scrollLI = scrollUL.find('li'),
        perLen = scrollLI.length, // 所需滚动元素的个数
        perWidth = 0; // 所需滚动元素的总长度

    var that,
        SCROLL = {
            init: function() {
                that = this;
                that.uiInit();
            },
            uiInit: function() {
                for(var i = 0; i < perLen; i++) {
                    // 计算所需滚动元素的总长度
                    var itemWidth = scrollLI.eq(i).outerWidth(true);

                    perWidth += itemWidth;
                }
                
                if(perWidth > scrollWidth) {
                    // 所需滚动距离大于外层容器宽度, clone元素
                    scrollUL.css('width', perWidth + 'px');

                    that.cloneLI();
                } else {
                    // 所需滚动距离小于外层容器宽度, 不做任何滚动处理
                    return false;
                }
            },
            cloneLI: function() {
                // 滚动容器的宽度置为所需滚动元素总长度的2倍
                scrollUL.css('width', 2 * perWidth + 'px');
                // 克隆所有元素
                scrollLI.clone().appendTo(scrollUL);

                that.handleScrolling();

                that.mouseOverBind();
            },
            handleScrolling: function() {
                // 定时器，每秒滚动speed px的距离
                that.XF = setInterval(function() {
                    that.scrolling();
                }, 1000/speed);
            },
            scrolling: function() {
                // 获取滚动容器相对于外层容器的X轴偏移量
                var left = scrollUL.position().left;

                if(left > -perWidth) {
                    // 如果滚动距离小于所需滚动元素的总长度，滚动距离+1
                    scrollUL.css('left', (left - 1) + 'px');
                } else {
                    // 滚动容器复位
                    scrollUL.css('left', 0);
                }
            },
            mouseOverBind: function() {
                scrollUL.on('mouseover', function() {
                    // 鼠标hover时，清除滚动定时器
                    clearInterval(that.XF);
                });

                scrollUL.on('mouseout', function() {
                    // 鼠标blur时，重新设定计时器
                    that.handleScrolling();
                });
            }
        };

    SCROLL.init();
})();
```
&nbsp;